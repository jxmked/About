"use strict";var __awaiter=this&&this.__awaiter||function(b,c,a,d){return new(a||(a=Promise))(function(f,g){function h(a){try{e(d.next(a))}catch(b){g(b)}}function i(a){try{e(d.throw(a))}catch(b){g(b)}}function e(b){var c;b.done?f(b.value):((c=b.value)instanceof a?c:new a(function(a){a(c)})).then(h,i)}e((d=d.apply(b,c||[])).next())})},__generator=this&&this.__generator||function(b,c){var d,e,f,a,_={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function g(a){return function(b){return h([a,b])}}function h(a){if(d)throw new TypeError("Generator is already executing.");for(;_;)try{if(d=1,e&&(f=2&a[0]?e.return:a[0]?e.throw||((f=e.return)&&f.call(e),0):e.next)&&!(f=f.call(e,a[1])).done)return f;switch(e=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return _.label++,{value:a[1],done:!1};case 5:_.label++,e=a[1],a=[0];continue;case 7:a=_.ops.pop(),_.trys.pop();continue;default:if(!(f=(f=_.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){_=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){_.label=a[1];break}if(6===a[0]&&_.label<f[1]){_.label=f[1],f=a;break}if(f&&_.label<f[2]){_.label=f[2],_.ops.push(a);break}f[2]&&_.ops.pop(),_.trys.pop();continue}a=c.call(b,_)}catch(g){a=[6,g],e=0}finally{d=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};window.addEventListener("DOMContentLoaded",function(){return __awaiter(void 0,void 0,void 0,function(){var a,b,c;return __generator(this,function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),[4,new Config().load()];case 1:if(d.sent(),!(b=(a=Config.config).github.username))return console.error("Github username does not exists"),[2];return GH_API.Username=b,[4,new getColors().then()];case 2:return d.sent(),new MostLanguages,[3,4];case 3:return c=d.sent(),console.error(c),console.error("Failed to parse userdata!"),console.error("Please check your inputs."),[3,4];case 4:return new NavigationPanel,NavigationPanel.addItem("Introduction","main-introduction"),NavigationPanel.addItem("About Me","main-about"),[2]}})})});var PP_Item_Create=function(){function a(a){this.obj=a,this.parent=document.createElement("div"),this.parent.classList.add("pp-items"),this.parent.classList.add("observable"),this.name(),this.description(),this.topics(),this.graphs(),this.callback=function(a){}}return Object.defineProperty(a.prototype,"Config",{set:function(c){var b=Config.config.github.personal_projects.target_topics;a.topicExceptions=b.map(function(a){return normalize(a)})},enumerable:!1,configurable:!0}),a.prototype.name=function(){var a=document.createElement("a"),b=document.createElement("label");a.setAttribute("href",this.obj.html_url),a.setAttribute("rel","noopener noreferrer"),a.setAttribute("target","_blank"),a.appendChild(document.createTextNode(this.obj.full_name)),b.appendChild(a),this.parent.appendChild(b)},a.prototype.description=function(){var a='"No description provided."',c=document.createElement("p"),d=document.createElement("div");try{var b=String(this.obj.description).trim();a=b&&"null"!=b?b:a}catch(e){}finally{c.appendChild(document.createTextNode(a)),d.appendChild(c),this.parent.appendChild(d)}},a.prototype.topics=function(){var c=document.createElement("ul"),b=document.createElement("div");this.obj.topics.forEach(function(b){if(!(a.topicExceptions.length>0)|| -1==a.topicExceptions.indexOf(normalize(b))){var d=document.createElement("li");d.appendChild(document.createTextNode(b.trim())),c.appendChild(d)}}),b.appendChild(c),this.parent.appendChild(b)},a.prototype.graphs=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c,d,e,f=this;return __generator(this,function(g){switch(g.label){case 0:return a=document.createElement("div"),b=document.createElement("ul"),c=0,d={},e=0,[4,gh_fetch(this.obj.languages_url,1).then(function(g){d=ObjectSort(g),Object.entries(g).length>0&&(e=Object.values(d).reduce(function(a,b){return a+b})),Object.keys(d).forEach(function(c){var h=getColors.color(c),g=d[c]/e*100;0==e&&(g=0);var i=f.create_bar_graph(g,h);a.appendChild(i);var j=f.create_ranking(c,g,h);b.appendChild(j)});var c=document.createElement("div");c.appendChild(a),c.appendChild(b),f.parent.appendChild(c),f.callback(f.parent)}).catch(function(a){console.error(a)})];case 1:return g.sent(),[2]}})})},a.prototype.create_bar_graph=function(b,c){var a=document.createElement("span");return a.style.backgroundColor=c,a.style.width=String(b)+"%",a},a.prototype.create_ranking=function(e,f,g){var d,b,c,a=document.createElement("li");(d=document.createElement("span")).style.backgroundColor=g,(b=document.createElement("p")).classList.add("language"),b.appendChild(document.createTextNode(e)),c=document.createElement("p");var h=parseFloat(String(f)).toFixed(2);return c.appendChild(document.createTextNode(h)),a.appendChild(d),a.appendChild(b),a.appendChild(c),a.classList.add("item"),a},a.prototype.then=function(a){this.callback=a},a.topicExceptions=[],a}(),MostLanguages=function(){function a(){var d=this;this.repoLang={},this.callbacks={onError:function(a){}},this.username=Config.config.github.username;var b=Config.config.github.mostly_used_languages.exception,c=Config.config.github.mostly_used_languages.max_display_language;a.maxLanguages=c,a.exceptLangs=b.map(function(a){return normalize(a)}),a.__is_initiated__||(a.__is_initiated__=!0,this.get_repositories(function(){d.beginCounting(),console.log(a.countedRepos)}))}return a.prototype.create_landing_page=function(){},a.prototype.beginCounting=function(){var c=this,b=ObjectSort(a.countLangs);Object.keys(b).splice(0,a.maxLanguages).forEach(function(a){c.repoLang[a]=b[a]}),this.createObject()},a.prototype.get_repositories=function(c){this.username="microsoft";var d="https://api.github.com/users/".concat(this.username,"/repos?per_page=50"),e=function(b,c,d){gh_fetch(b.languages_url,1).then(function(h,i){for(var e=0,f=Object.entries(h);e<f.length;e++){var g=f[e],d=g[0],j=g[1];-1==a.exceptLangs.indexOf(normalize(d))&&(a.countLangs[d]||(a.countLangs[d]=0),a.countLangs[d]+=j)}i?console.log("Error: ".concat(b.name)):a.countedRepos++,c()},!0).catch(function(a){return d(a)})},b=function(a,f){var g=0,c=d;a>1&&(c="".concat(d,"&page=").concat(a)),gh_fetch(c,1).then(function(c){if(0==c.length){f();return}c.forEach(function(d){e(d,function(){g++,c.length==g&&b(a+1,f)},f)})})},f=!1;b(1,function(){f||c(),f=!0})},a.prototype.createObjectAttribute=function(d,e,g){var b=document.createElement("span"),f=document.createElement("p"),c=document.createElement("span"),a=document.createElement("li");b.style.backgroundColor=d,b.setAttribute("data-value",d),a.appendChild(b),f.appendChild(document.createTextNode(g)),a.appendChild(f);var h=parseFloat(e).toFixed(2);return c.appendChild(document.createTextNode("".concat(h,"%"))),c.setAttribute("data-value",e),a.appendChild(c),a},a.prototype.createObject=function(){var k=this;document.createElement("div");var l=Object.values(this.repoLang).reduce(function(a,b){return a+b}),h=ObjectSort(this.repoLang),i=document.createElement("div"),j=document.createElement("ul");Object.entries(h).forEach(function(_){var c=_[0],b=String(_[1]/l*100),d=getColors.color(c),a=document.createElement("span");a.style.backgroundColor=d,a.style.width=b+"%",a.setAttribute("data-value",b),i.appendChild(a),j.appendChild(k.createObjectAttribute(d,b,c))});var e=document.createElement("div");e.appendChild(i);var f=document.createElement("div");f.appendChild(j);var c=document.createElement("label"),d=document.createElement("span");c.appendChild(document.createTextNode("Known Languages:")),d.appendChild(document.createTextNode("from Github")),d.classList.add("tooltip"),c.appendChild(d);var a=document.createElement("div");a.appendChild(c),a.appendChild(e),a.appendChild(f);var g=document.getElementById("main-about"),b=document.createElement("div");b.appendChild(a),b.setAttribute("id","main-languages"),b.classList.add("observable"),g.parentNode.insertBefore(b,g.nextSibling)},a.maxLanguages=0,a.exceptLangs=[],a.countedRepos=0,a.__is_initiated__=!1,a.countLangs={},a}(),NavigationPanel=function(){function a(){document.getElementById("nav-panel").addEventListener("click",function(){document.getElementById("--cb-burger-menu").click()},!0)}return a.addItem=function(a,c){var d=[void 0,0,null,""];if(a=String(a).trim(),c=encodeURI(String(c)),-1!=d.indexOf(a)|| -1!=d.indexOf(c))throw new Error("Unable to add");var e=document.createElement("li"),b=document.createElement("a");b.appendChild(document.createTextNode(a)),b.setAttribute("href","#".concat(c)),b.setAttribute("rel","noreferrer origin"),b.setAttribute("alt","Navigate to ".concat(a)),e.appendChild(b);try{document.getElementById("nav-panel-list").appendChild(e)}catch(f){console.error("Unable to insert element"),console.error(f)}},a}(),PersonalProjects=function(){function a(){this.repositories=[],this.callbacks={onError:function(a){console.error(a)}};var b=Config.config.github.username,c=Config.config.github.personal_projects.target_topics,d=Config.config.github.personal_projects.max_display_projects,e=Config.config.github.personal_projects.hide_projects;this.topicIncludes=c.map(function(a){return normalize(a)}),this.hideProjects=e.map(function(a){return normalize(a)}),this.maxProjects=Number(d),this.url="https://api.github.com/users/".concat(b,"/repos"),a.__is_initiated__||(a.__is_initiated__=!0,this.__start__())}return a.prototype.__start__=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c,d,e,f,g=this;return __generator(this,function(h){switch(h.label){case 0:return a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),a.setAttribute("id","main-personal-projects"),d=document.createElement("label"),e=document.createElement("span"),d.appendChild(document.createTextNode("Some Personal Projects:")),e.appendChild(document.createTextNode("from Github")),e.classList.add("tooltip"),d.appendChild(e),b.appendChild(d),a.appendChild(b),f=document.getElementById("main-about"),[4,gh_fetch(this.url,1).then(function(d){d.filter(function(a){return g.topicIncludes.length<1||a.topics.some(function(a){return -1!=g.topicIncludes.indexOf(a)})}).forEach(function(a){new PP_Item_Create(a).then(function(a){a.setAttribute("data-state","hide"),c.appendChild(a)})}),c.setAttribute("id","pp-list"),b.appendChild(c),NavigationPanel.addItem("Personal Projects","main-personal-projects"),f.parentNode.insertBefore(a,f.nextSibling)}).catch(function(a){console.error(a)})];case 1:return h.sent(),[2]}})})},a.__is_initiated__=!1,a}();function normalize(a){return String(a).replaceAll(/\s/g,"").toLowerCase()}function ObjectSort(b){var a=Object.keys(b).map(function(a){return{key:a,value:b[a]}}),c={};return(a=a.sort(function(a,b){return b.value-a.value})).forEach(function(a){return c[a.key]=a.value}),c}function safeConcat(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return b.map(function(a){return String(a).trim().replace(/^\//,"").replace(/\/$/,"")}).join("/")}var Config=function(){function a(){this.__url=safeConcat(window.location.origin,"config.json")}return a.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return[4,fetch(this.__url,{method:"GET",mode:"cors",cache:"force-cache",redirect:"follow",referrerPolicy:"no-referrer"}).then(function(a){return a.json()}).then(function(b){a.__config=b}).catch(function(a){console.error(a)})];case 1:return b.sent(),[2]}})})},Object.defineProperty(a,"config",{get:function(){return a.__config},enumerable:!1,configurable:!0}),a.__config={},a}(),GH_API=function(){function a(b,a){if("number"!=typeof a||a<0)throw new TypeError("Expiration should be a positive number");this.__expiry__=a,this.__url__=b,this.__config__={method:"GET",mode:"cors",cache:"force-cache",redirect:"follow",referrerPolicy:"no-referrer",headers:{Authorization:"token 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"}}}return a.prototype.then=function(c,b){return void 0===b&&(b=!1),__awaiter(this,void 0,void 0,function(){var d=this;return __generator(this,function(e){switch(e.label){case 0:return[4,new Promise(function(c,e){return __awaiter(d,void 0,void 0,function(){var d,f,g,h,i,j,k;return __generator(this,function(l){switch(l.label){case 0:d=this.__url__,l.label=1;case 1:return l.trys.push([1,3,,14]),[4,this.getFromDB(d,!1,function(a){c([a,!1])})];case 2:return l.sent(),[3,14];case 3:if(!("expired"==(f=l.sent()).message||"empty"==f.message))throw f;g=void 0,l.label=4;case 4:return l.trys.push([4,6,,7]),[4,fetch(this.__url__,this.__config__)];case 5:return g=l.sent(),[3,7];case 6:return h=l.sent(),b?c([{},!0]):e(),[2];case 7:if(!(200!=g.status))return[3,12];if(!("expired"==f.message&&403==g.status))return[3,9];return[4,this.getFromDB(d,!0,function(a){c([a,!1])})];case 8:return l.sent(),[2];case 9:if(403!=g.status)return[3,11];return[4,g.json()];case 10:if("unavailable"==(i=l.sent()).block.reason&&b)return c([{},!0]),[2];l.label=11;case 11:return e("No available sources"),[2];case 12:return[4,g.text()];case 13:j=l.sent(),j=JSON.parse(j),k=new Date().getTime(),k+=36e5*this.__expiry__;try{a.saveData(d,j,k)}catch(m){return e(),[2]}return c([j,!1]),[3,14];case 14:return[2]}})})}).then(function(a){c(a[0],a[1])})];case 1:return[2,e.sent()]}})})},Object.defineProperty(a,"Username",{get:function(){return a.username},set:function(b){if((b=String(b).trim()).length<3)throw new TypeError("Invalid Github username.");a.username=b},enumerable:!1,configurable:!0}),a.prototype.getFromDB=function(b,c,d){return __awaiter(this,void 0,void 0,function(){var e,f,g,h;return __generator(this,function(i){switch(i.label){case 0:return[4,a.__getDB__()];case 1:e=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),f=!1,[4,e.getItem(b).then(function(b){var a=JSON.parse(b);if(c){d(a.data);return}try{if(Number(a.expiry)>=new Date().getTime()){d(a.data);return}}catch(e){throw new Error("empty")}if(f)throw new Error("expired")}).catch(function(a){throw a})];case 3:return i.sent(),[3,5];case 4:if(g=i.sent(),-1!=(h=["expired","empty"]).indexOf(g.message))throw g;return[3,5];case 5:return[2]}})})},a.saveData=function(b,c,d){return __awaiter(this,void 0,void 0,function(){var e,f;return __generator(this,function(g){switch(g.label){case 0:return[4,a.__getDB__()];case 1:e=g.sent(),f={save_time:new Date().getTime(),data:c,expiry:d};try{e.setItem(b,JSON.stringify(f))}catch(h){throw h}return[2]}})})},a.__getDB__=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,localforage.createInstance({name:"gh_fetched",storeName:"urls",description:"Stored Data"})];case 1:return[2,a.sent()]}})})},a.username="",a}();function gh_fetch(a,b){return new GH_API(a,b)}var getColors=function(){function a(){this.__url=window.location.origin+"/assets/data/colors.json"}return a.prototype.then=function(b){return void 0===b&&(b=function(a){}),__awaiter(this,void 0,void 0,function(){return __generator(this,function(c){switch(c.label){case 0:return[4,fetch(this.__url,{method:"GET",mode:"cors",cache:"force-cache",redirect:"follow",referrerPolicy:"no-referrer"}).then(function(a){return a.json()}).then(function(c){a.colors=c,b(c)})];case 1:return[2,c.sent()]}})})},a.color=function(b){try{return String(a.colors[b])}catch(d){for(var c in a.colors)if(String(c).trim().toLowerCase()==b.trim().toLowerCase())return String(a.colors[c])}return"#f0f0f0"},a}()